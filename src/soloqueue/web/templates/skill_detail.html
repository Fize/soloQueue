{% extends "base.html" %}

{% block title %}{{ skill.name }} | SoloQueue{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb mb-0 small">
            <li class="breadcrumb-item"><a href="/skills">Skills</a></li>
            <li class="breadcrumb-item active">{{ skill.name }}</li>
        </ol>
    </nav>
    <div class="btn-group" x-data="{ deleting: false }">
        <a href="/skills/{{ skill.name }}/edit" class="btn btn-primary btn-sm"><i class="bi bi-pencil me-1"></i>
            Edit</a>
        <button type="button" class="btn btn-outline-danger btn-sm" :disabled="deleting"
            @click="if(confirm('Are you sure you want to delete skill \'{{ skill.name }}\'? This will remove the entire skill directory.')) {
                deleting = true;
                fetch('/api/skills/{{ skill.name }}', { method: 'DELETE' })
                    .then(r => r.json())
                    .then(d => { if(d.status === 'success') window.location.href = '/skills'; else { alert(d.message); deleting = false; } })
                    .catch(e => { alert('Error: ' + e); deleting = false; });
            }">
            <i class="bi bi-trash me-1"></i> Delete
        </button>
    </div>
</div>

<div class="card shadow-sm border-0 mb-4">
    <div class="card-body">
        <h3 class="card-title fw-bold mb-1">{{ skill.name }}</h3>
        <p class="text-muted">{{ skill.description }}</p>

        <div class="row g-3 mt-2">
            <div class="col-md-6">
                <small class="text-uppercase text-muted fw-bold d-block mb-1">Allowed Tools</small>
                {% if skill.allowed_tools %}
                {% for tool in skill.allowed_tools %}
                <span class="badge bg-light text-secondary border fw-normal">{{ tool }}</span>
                {% endfor %}
                {% else %}
                <span class="text-muted fst-italic small">None</span>
                {% endif %}
            </div>

            <div class="col-md-6">
                <small class="text-uppercase text-muted fw-bold d-block mb-1">Capabilities</small>
                <div class="d-flex gap-2">
                    {% if skill.disable_model_invocation %}
                    <span class="badge bg-warning text-dark"><i class="bi bi-person-x-fill me-1"></i> Manual Only</span>
                    {% else %}
                    <span class="badge bg-success bg-opacity-10 text-success"><i class="bi bi-magic me-1"></i> AI
                        Callable</span>
                    {% endif %}

                    {% if skill.subagent %}
                    <span class="badge bg-info bg-opacity-10 text-info"><i class="bi bi-box-arrow-in-right me-1"></i>
                        Subagent: {{ skill.subagent }}</span>
                    {% endif %}
                </div>
            </div>
        </div>

        {% if skill.arguments %}
        <div class="mt-4">
            <small class="text-uppercase text-muted fw-bold d-block mb-2">Arguments</small>
            <code class="bg-light px-2 py-1 rounded">{{ skill.arguments }}</code>
        </div>
        {% endif %}
    </div>
</div>

<div class="card shadow-sm border-0">
    <div class="card-header bg-white fw-bold">
        <i class="bi bi-file-text me-2"></i> Prompt Template
    </div>
    <div class="card-body bg-light p-0">
        <pre class="m-0 p-3"
            style="font-family: 'Consolas', monospace; font-size: 0.9rem; max-height: 600px; overflow-y: auto;">{{ skill.content }}</pre>
    </div>
</div>
{% endblock %}